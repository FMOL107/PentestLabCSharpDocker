FROM debian:stable

ENV DEBIAN_FRONTEND="noninteractive"
RUN apt-get update && apt-get install -y \
        --no-install-recommends \
        xorg \
        dbus-x11 \
        firefox-esr \
        git \
        locales \
        pavucontrol \
        pulseaudio \
        pulseaudio-utils \
        sudo \
        x11-xserver-utils \
        xfce4 \
        xfce4-goodies \
        xfce4-pulseaudio-plugin \
        xorgxrdp \
        xrdp \
        iproute2 \
        nmap \
        wget \
        ssh \
        iputils-ping

RUN groupadd --gid 1020 debian
RUN useradd --shell /bin/bash --uid 1020 --gid 1020 --password $(openssl passwd debian) --create-home --home-dir /home/debian debian
RUN usermod -aG sudo debian

# Start services
CMD /usr/sbin/xrdp-sesman && /usr/sbin/xrdp --nodaemon


# Build
# docker build . -f debian-rdp.dockerfile -t debian-rdp

# Run
# docker run -d -p 3389:3389 --name debian-rdp --hostname debian-rdp debian-rdp
